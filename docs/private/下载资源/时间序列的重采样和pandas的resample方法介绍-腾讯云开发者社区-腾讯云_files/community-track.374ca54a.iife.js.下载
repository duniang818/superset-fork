this["community-track"]=function(){"use strict";function t(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function e(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m(n.key),n)}}function o(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function i(t,e,r){return(e=m(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(u){l=!0,o=u}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||v(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=v(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function m(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}!function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var t=function(t){for(var e=window.document,r=o(e);r;)r=o(e=r.ownerDocument);return e}(),e=[],r=null,n=null;a.prototype.THROTTLE_TIMEOUT=100,a.prototype.POLL_INTERVAL=null,a.prototype.USE_MUTATION_OBSERVER=!0,a._setupCrossOriginUpdater=function(){return r||(r=function(t,r){n=t&&r?d(t,r):{top:0,bottom:0,left:0,right:0,width:0,height:0},e.forEach((function(t){t._checkForIntersections()}))}),r},a._resetCrossOriginUpdater=function(){r=null,n=null},a.prototype.observe=function(t){if(!this._observationTargets.some((function(e){return e.element==t}))){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(t.ownerDocument),this._checkForIntersections()}},a.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter((function(e){return e.element!=t})),this._unmonitorIntersections(t.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},a.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},a.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},a.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter((function(t,e,r){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==r[e-1]}))},a.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map((function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}}));return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},a.prototype._monitorIntersections=function(e){var r=e.defaultView;if(r&&-1==this._monitoringDocuments.indexOf(e)){var n=this._checkForIntersections,i=null,a=null;this.POLL_INTERVAL?i=r.setInterval(n,this.POLL_INTERVAL):(c(r,"resize",n,!0),c(e,"scroll",n,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in r&&(a=new r.MutationObserver(n)).observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(e),this._monitoringUnsubscribes.push((function(){var t=e.defaultView;t&&(i&&t.clearInterval(i),s(t,"resize",n,!0)),s(e,"scroll",n,!0),a&&a.disconnect()}));var l=this.root&&(this.root.ownerDocument||this.root)||t;if(e!=l){var u=o(e);u&&this._monitorIntersections(u.ownerDocument)}}},a.prototype._unmonitorIntersections=function(e){var r=this._monitoringDocuments.indexOf(e);if(-1!=r){var n=this.root&&(this.root.ownerDocument||this.root)||t;if(!this._observationTargets.some((function(t){var r=t.element.ownerDocument;if(r==e)return!0;for(;r&&r!=n;){var i=o(r);if((r=i&&i.ownerDocument)==e)return!0}return!1}))){var i=this._monitoringUnsubscribes[r];if(this._monitoringDocuments.splice(r,1),this._monitoringUnsubscribes.splice(r,1),i(),e!=n){var a=o(e);a&&this._unmonitorIntersections(a.ownerDocument)}}}},a.prototype._unmonitorAllIntersections=function(){var t=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var e=0;e<t.length;e++)t[e]()},a.prototype._checkForIntersections=function(){if(this.root||!r||n){var t=this._rootIsInDom(),e=t?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(n){var o=n.element,a=l(o),c=this._rootContainsTarget(o),s=n.entry,u=t&&c&&this._computeTargetAndRootIntersection(o,a,e),d=null;this._rootContainsTarget(o)?r&&!this.root||(d=e):d={top:0,bottom:0,left:0,right:0,width:0,height:0};var h=n.entry=new i({time:window.performance&&performance.now&&performance.now(),target:o,boundingClientRect:a,rootBounds:d,intersectionRect:u});s?t&&c?this._hasCrossedThreshold(s,h)&&this._queuedEntries.push(h):s&&s.isIntersecting&&this._queuedEntries.push(h):this._queuedEntries.push(h)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},a.prototype._computeTargetAndRootIntersection=function(e,o,i){if("none"!=window.getComputedStyle(e).display){for(var a,c,s,u,h,f,p,m,g=o,y=v(e),b=!1;!b&&y;){var w=null,I=1==y.nodeType?window.getComputedStyle(y):{};if("none"==I.display)return null;if(y==this.root||9==y.nodeType)if(b=!0,y==this.root||y==t)r&&!this.root?!n||0==n.width&&0==n.height?(y=null,w=null,g=null):w=n:w=i;else{var S=v(y),k=S&&l(S),_=S&&this._computeTargetAndRootIntersection(S,k,i);k&&_?(y=S,w=d(k,_)):(y=null,g=null)}else{var T=y.ownerDocument;y!=T.body&&y!=T.documentElement&&"visible"!=I.overflow&&(w=l(y))}if(w&&(a=w,c=g,s=void 0,u=void 0,h=void 0,f=void 0,p=void 0,m=void 0,s=Math.max(a.top,c.top),u=Math.min(a.bottom,c.bottom),h=Math.max(a.left,c.left),f=Math.min(a.right,c.right),m=u-s,g=(p=f-h)>=0&&m>=0&&{top:s,bottom:u,left:h,right:f,width:p,height:m}||null),!g)break;y=y&&v(y)}return g}},a.prototype._getRootRect=function(){var e;if(this.root&&!f(this.root))e=l(this.root);else{var r=f(this.root)?this.root:t,n=r.documentElement,o=r.body;e={top:0,left:0,right:n.clientWidth||o.clientWidth,width:n.clientWidth||o.clientWidth,bottom:n.clientHeight||o.clientHeight,height:n.clientHeight||o.clientHeight}}return this._expandRectByRootMargin(e)},a.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map((function(e,r){return"px"==e.unit?e.value:e.value*(r%2?t.width:t.height)/100})),r={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return r.width=r.right-r.left,r.height=r.bottom-r.top,r},a.prototype._hasCrossedThreshold=function(t,e){var r=t&&t.isIntersecting?t.intersectionRatio||0:-1,n=e.isIntersecting?e.intersectionRatio||0:-1;if(r!==n)for(var o=0;o<this.thresholds.length;o++){var i=this.thresholds[o];if(i==r||i==n||i<r!=i<n)return!0}},a.prototype._rootIsInDom=function(){return!this.root||h(t,this.root)},a.prototype._rootContainsTarget=function(e){var r=this.root&&(this.root.ownerDocument||this.root)||t;return h(r,e)&&(!this.root||r==e.ownerDocument)},a.prototype._registerInstance=function(){e.indexOf(this)<0&&e.push(this)},a.prototype._unregisterInstance=function(){var t=e.indexOf(this);-1!=t&&e.splice(t,1)},window.IntersectionObserver=a,window.IntersectionObserverEntry=i}function o(t){try{return t.defaultView&&t.defaultView.frameElement||null}catch(e){return null}}function i(t){this.time=t.time,this.target=t.target,this.rootBounds=u(t.rootBounds),this.boundingClientRect=u(t.boundingClientRect),this.intersectionRect=u(t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,r=e.width*e.height,n=this.intersectionRect,o=n.width*n.height;this.intersectionRatio=r?Number((o/r).toFixed(4)):this.isIntersecting?1:0}function a(t,e){var r,n,o,i=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(i.root&&1!=i.root.nodeType&&9!=i.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(r=this._checkForIntersections.bind(this),n=this.THROTTLE_TIMEOUT,o=null,function(){o||(o=setTimeout((function(){r(),o=null}),n))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(i.rootMargin),this.thresholds=this._initThresholds(i.threshold),this.root=i.root||null,this.rootMargin=this._rootMarginValues.map((function(t){return t.value+t.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function c(t,e,r,n){"function"==typeof t.addEventListener?t.addEventListener(e,r,n||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,r)}function s(t,e,r,n){"function"==typeof t.removeEventListener?t.removeEventListener(e,r,n||!1):"function"==typeof t.detachEvent&&t.detachEvent("on"+e,r)}function l(t){var e;try{e=t.getBoundingClientRect()}catch(r){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function u(t){return!t||"x"in t?t:{top:t.top,y:t.top,bottom:t.bottom,left:t.left,x:t.left,right:t.right,width:t.width,height:t.height}}function d(t,e){var r=e.top-t.top,n=e.left-t.left;return{top:r,left:n,height:e.height,width:e.width,bottom:r+e.height,right:n+e.width}}function h(t,e){for(var r=e;r;){if(r==t)return!0;r=v(r)}return!1}function v(e){var r=e.parentNode;return 9==e.nodeType&&e!=t?o(e):(r&&r.assignedSlot&&(r=r.assignedSlot.parentNode),r&&11==r.nodeType&&r.host?r.host:r)}function f(t){return t&&9===t.nodeType}}();var g=o((function t(){var n=this;r(this,t),i(this,"pvId",void 0),i(this,"report",(function(t){var r,o,i,a,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="qcdeveloper_".concat(t),l=e(e({},c),{},{pvId:n.pvId,$url_path:document.location.pathname,$referrer:document.referrer});null===(r=window)||void 0===r||null===(o=r.QC_AUTOTRACK)||void 0===o||o.dtReport(s,l,"onUserAction"),null===(i=window)||void 0===i||null===(a=i.QC_SENSORS)||void 0===a||a.track(s,l,{dtReport:!1})})),this.pvId=t.nanoid}));i(g,"nanoid",((t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce(((t,e)=>t+=(e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_"),""))());var y={bold:1,italic:2,strike:3,code:4,h1:5,h2:6,h3:7,blockquote:8,"code-block":9,ol:10,ul:11,link:12,pic:13,table:14,theme:15,catalogue:16,hr:17,sigma:18,"delete-link":19,video:20,word:21,ppt:22,attachment:23,"table-align-left":24,"table-align-center":25,"table-align-right":26,"table-insert-row-above":27,"table-insert-row-below":28,"table-insert-col-left":29,"table-insert-col-right":30,"table-combine-cells":31,"table-split-cell":32,"table-remove-row":33,"table-remove-column":34,"table-remove-table":35,"sigma-inline":36,"sigma-block":37,"trigger-left":38},b=function(t){a(n,t);var e=d(n);function n(){var t;return r(this,n),i(l(t=e.call(this)),"clickStartSelector",["col-editor-header-top","article-title-wrap","editor-wrapper"]),i(l(t),"processId",0),i(l(t),"isCreating",!1),i(l(t),"startTime",Date.now()),i(l(t),"duration",0),i(l(t),"containerSelector","body"),i(l(t),"timerHandle",void 0),i(l(t),"reportInterval",10),i(l(t),"isDraged",!1),i(l(t),"startIntervalReport",(function(){t.stopIntervalReport(),t.startTime=Date.now(),t.timerHandle=setInterval((function(){t.reportDuration()}),1e3*t.reportInterval)})),i(l(t),"stopIntervalReport",(function(){t.timerHandle&&(clearInterval(t.timerHandle),t.timerHandle=null)})),i(l(t),"addVisibilityChangeHandler",(function(){var e=l(t);document.addEventListener("visibilitychange",(function(){e.isCreating&&("hidden"===document.visibilityState?(e.reportDuration(),e.stopIntervalReport()):e.startIntervalReport())}))})),i(l(t),"addChangeHandler",(function(){var e=l(t);document.addEventListener("change",(function(t){var r=t.target;if(r.matches("select.code-syntax-select")){r.value;e.reportClick(114005,r.selectedIndex+1)}}))})),i(l(t),"addClickHandler",(function(){var e;null===(e=document.querySelector(t.containerSelector))||void 0===e||e.addEventListener("click",t.clickHandler,!0)})),i(l(t),"findParentNode",(function(t,e){for(var r=t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;n>0;){var o,i;if(n--,r.matches(e))return r;(null===(o=r)||void 0===o?void 0:o.parentNode)===document.body&&(n=1),r=null===(i=r)||void 0===i?void 0:i.parentNode}return null})),i(l(t),"clickHandler",(function(e){var r=e.target;t.isCreating||t.checkStartTrackDom(r)&&t.startCreate();if(r.matches(".col-editor-switch a"))"切换到Markdown编辑器"===r.textContent?t.reportClick(114006,1):t.reportClick(114006,2);else if(r.matches("span.rich-text-back2top")&&"返回顶部"===r.textContent)t.reportClick(114006,4);else if(r.matches("span.markdown-text-back2top")&&"返回顶部"===r.textContent)t.reportClick(114006,3);else if(r.matches(".col-editor-side-menu i.side-menu-close")&&"关闭"===r.textContent)t.reportClick(114006,5);else{if(document.querySelector(".col-draft-list")){if(r.matches(".draft-item .draft-btns button.draft-btn")||r.matches(".draft-item .draft-btns button.draft-btn i"))return void t.reportClick(114006,9);if(t.findParentNode(r,".col-draft-list .draft-item a"))return void t.reportClick(114006,8)}if(r.matches("a.header-link")&&r.textContent.includes("草稿箱"))t.reportClick(114006,6);else if(r.matches("a.sidebar-trigger")&&"关闭"===r.textContent)t.reportClick(114006,7);else{if(r.matches(".c-modal-inner a.c-dialog-hd-close")&&"关闭"===r.title){var n=t.getDiglogType(r);return"draftDialog"===n&&t.reportClick(114006,11),void("editImgDialog"===n&&t.reportClick(114006,14))}if(r.matches(".c-modal-inner  button.c-btn")&&"确定"===r.textContent){var o=t.getDiglogType(r);return"draftDialog"===o&&t.reportClick(114006,12),void("editImgDialog"===o&&t.reportClick(114006,15))}if(r.matches(".c-modal-inner  button.c-btn-hole")&&"取消"===r.textContent){var i=t.getDiglogType(r);return"draftDialog"===i&&t.reportClick(114006,13),void("editImgDialog"===i&&t.reportClick(114006,16))}if(r.matches("span.edit-image-form-tip")&&"原始大小"===r.textContent)t.reportClick(114006,10);else{var a=t.findParentNode(r,"button.qa-r-editor-btn");if(a){var c,s,l,u,d=Array.from(null!==(c=null===(s=a.querySelector("i"))||void 0===s?void 0:s.classList)&&void 0!==c?c:[]).find((function(t){return-1!==t.indexOf("qa-ico-")}));if(d)return"menu"===(d=d.replace("qa-ico-",""))&&(d="catalogue"),void t.reportClick(114001,y[d],-1!==(null===(l=document.querySelector(".col-editor-switch a"))||void 0===l||null===(u=l.textContent)||void 0===u?void 0:u.indexOf("Markdown"))?"richtext":"markdown")}if(r.matches(".table-editor-context-menu ul li")){var h=null==r?void 0:r.textContent;if(h){/^删除.+行$/.test(h)?h="删除x行":/^删除.+列$/.test(h)&&(h="删除x列"),t.reportClick(114002,{"左对齐":1,"居中对齐":2,"右对齐":3,"在上方插入行":4,"在下方插入行":5,"在左侧插入列":6,"在右侧插入列":7,"清空单元格内容":8,"合并单元格":9,"删除x行":10,"删除x列":11,"删除表格":12}[h])}}else if(r.matches(".image-block-actions  .action-bar__item .action-bar__item-icon")){var v,f=Array.from(null!==(v=null==r?void 0:r.classList)&&void 0!==v?v:[]).find((function(t){return-1!==t.indexOf("icon-")}));if(f){var p;f=null===(p=f)||void 0===p?void 0:p.replace("icon-",""),t.reportClick(114003,{"align-left":1,"align-center":2,"align-right":3,"no-shadow":4,shadow:5,delete:6,more:7,describe:8}[f])}}else if(r.matches(".image-block-wrapper figcaption")&&"添加描述"===r.textContent)t.reportClick(114003,8);else{var m=t.findParentNode(r,"div.qa-r-editor-dropdown-item");if(m){var g,b=null===(g=m.querySelector("p"))||void 0===g?void 0:g.textContent;if(b){t.reportClick(114004,{"无主题":1,"theme-blue":2,"round-label-blue":3,"code-gray":4,"theme-orange":5,"technology-style":6}[b])}}}}}}})),i(l(t),"checkStartTrackDom",(function(e){var r,n=p(t.clickStartSelector);try{for(n.s();!(r=n.n()).done;){var o,i=r.value;if(e.classList.contains(i))return!0;if(null!==(o=document.querySelector("."+i))&&void 0!==o&&o.contains(e))return!0}}catch(a){n.e(a)}finally{n.f()}return!1})),i(l(t),"stopCreate",(function(){t.reportDuration(),t.stopIntervalReport(),t.isCreating=!1})),i(l(t),"startCreate",(function(){t.isCreating=!0,t.processId++,t.startIntervalReport()})),"https://cloud.tencent.com/developer/article/write"!==location.href?u(t):(t.polyfill(),t.addVisibilityChangeHandler(),t.addClickHandler(),t.addChangeHandler(),t.addImgDragHandler(),t)}return o(n,[{key:"polyfill",value:function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=document.querySelectorAll(t),r=e.length;--r>=0&&e.item(r)!==this;);return r>-1})}},{key:"addImgDragHandler",value:function(){var t=this,e=function(){t.isDraged=!0};document.addEventListener("mousedown",(function(t){var r=t.target;r&&r.matches("i.drag-box")&&document.addEventListener("mousemove",e)})),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",e),t.isDraged&&(t.report("drag",{areaId:114007,objectType:"editor"}),t.isDraged=!1)}))}},{key:"reportDuration",value:function(){var t=Date.now()-this.startTime+this.duration,e={duration:t,processId:this.processId};new Date;this.report("editorStay",e),this.duration=t,this.startTime=Date.now()}},{key:"getDiglogType",value:function(t){var e=this.findParentNode(t,".c-dialog");if(e){var r,n,o=null===(r=e.querySelector(".c-dialog-confirm-desc"))||void 0===r?void 0:r.textContent,i=null===(n=e.querySelector(".c-dialog-hd-title"))||void 0===n?void 0:n.textContent;if(null!=o&&o.includes("确定放弃此次编辑，加载草稿箱的内容"))return"draftDialog";if(null!=i&&i.includes("编辑图片"))return"editImgDialog"}}},{key:"reportClick",value:function(t,e,r){var n={areaId:t,elementId:e,objectId:this.processId,objectType:"editor"};r&&(n.mode=r),this.report("click",n)}}]),n}(g),w=function(t){a(c,t);var n=d(c);function c(t){var o,a,s,u,d,h,v;r(this,c),i(l(v=n.call(this)),"status","idle"),i(l(v),"checkPageIdleTimer",void 0),i(l(v),"idleDuration",10),i(l(v),"isFirstActive",!1),i(l(v),"activeStartTime",Date.now()),i(l(v),"pageStayDuration",0),i(l(v),"clickSelector","track-click"),i(l(v),"hoverSelector","track-hover"),i(l(v),"exposureSelector","track-exposure"),i(l(v),"stopCaptureSelector","track-stop-capture"),i(l(v),"containerSelector","body"),i(l(v),"intersectionObserver",void 0),i(l(v),"areaStayMap",new Map),i(l(v),"stayLengthReportTimer",void 0),i(l(v),"stayLengthReportInterval",5),i(l(v),"isDev",!1),i(l(v),"startIntervalReport",(function(){v.stayLengthReportTimer=setInterval((function(){v.reportPageStay(),v.reportAreaStay()}),1e3*v.stayLengthReportInterval)})),i(l(v),"stopIntervalReport",(function(){v.stayLengthReportTimer&&(clearInterval(v.stayLengthReportTimer),v.stayLengthReportTimer=null)})),i(l(v),"setPageActive",(function(){v.isFirstActive||(v.isFirstActive=!0,v.activeStartTime=Date.now(),v.report("pageView")),"idle"===v.status&&(v.activeStartTime=Date.now(),v.updateAreaStayActiveTime(),v.stopIntervalReport(),v.startIntervalReport()),v.status="active",v.stopCheckPageIdleTimer(),v.startCheckPageIdleTimer()})),i(l(v),"setPageIdle",(function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"active"===v.status&&(v.pageStayDuration=Date.now()-v.activeStartTime+v.pageStayDuration,v.report("pageStay",{duration:v.pageStayDuration}),v.reportAreaStay(t),v.stopIntervalReport()),v.status="idle"})),i(l(v),"visibilitychangeHandler",(function(){"hidden"===document.visibilityState?v.setPageIdle(!0):v.setPageActive()})),i(l(v),"startCheckPageIdleTimer",(function(){v.checkPageIdleTimer=setTimeout((function(){v.setPageIdle()}),1e3*v.idleDuration)})),i(l(v),"stopCheckPageIdleTimer",(function(){clearTimeout(v.checkPageIdleTimer)})),i(l(v),"addActivePageListener",(function(){document.addEventListener("click",v.setPageActive),document.addEventListener("mousemove",v.setPageActive,{passive:!0}),document.addEventListener("scroll",v.setPageActive,{passive:!0}),document.addEventListener("touchmove",v.setPageActive,{passive:!0}),document.addEventListener("keypress",v.setPageActive),document.addEventListener("wheel",v.setPageActive,{passive:!0}),document.addEventListener("visibilitychange",v.visibilitychangeHandler)})),i(l(v),"clearActivePageListener",(function(){document.removeEventListener("click",v.setPageActive),document.removeEventListener("mousemove",v.setPageActive),document.removeEventListener("scroll",v.setPageActive),document.removeEventListener("touchmove",v.setPageActive),document.removeEventListener("keypress",v.setPageActive),document.removeEventListener("wheel",v.setPageActive),document.removeEventListener("visibilitychange",v.visibilitychangeHandler)})),i(l(v),"trackClick",(function(){var t;null===(t=document.querySelector(v.containerSelector))||void 0===t||t.addEventListener("click",v.clickHandler,!0)})),i(l(v),"mergeAttrParam",(function(t,r){return null!=r&&r.subAreaId&&(null!=t&&t.elementId&&(t.subElementId=null==t?void 0:t.elementId,null==t||delete t.elementId),null!=t&&t.positionId&&(t.subPositionId=null==t?void 0:t.positionId,null==t||delete t.elementId)),e(e({},t),r)})),i(l(v),"clickHandler",(function(t){var e=t.target,r=e.getAttribute(v.clickSelector);if(!e.hasAttribute(v.stopCaptureSelector)){var n=void 0,o=v.paramsParse(r);if(r&&o&&o.areaId)v.report("click",null!=o?o:{});else{o&&(n=o);for(var i=e;i!==document.querySelector(v.containerSelector);){var a,c,s,l=i.getAttribute(v.clickSelector),u=v.paramsParse(l);if(l&&u&&u.areaId)return void v.report("click",null!==(a=v.mergeAttrParam(null!==(c=n)&&void 0!==c?c:{},u))&&void 0!==a?a:{});if(u&&(n=v.mergeAttrParam(null!==(s=n)&&void 0!==s?s:{},u)),!i.parentElement)break;if((i=i.parentElement).hasAttribute(v.stopCaptureSelector))return}}}})),i(l(v),"trackHover",(function(){var t;null===(t=document.querySelector(v.containerSelector))||void 0===t||t.addEventListener("mouseover",v.hoverHandler)})),i(l(v),"hoverHandler",(function(t){var e=t.target,r=e.getAttribute(v.hoverSelector);if(r){var n=v.paramsParse(r);v.report("hover",null!=n?n:{})}else for(var o=e;o!==document.querySelector(v.containerSelector);){var i=o.getAttribute(v.hoverSelector);if(i){var a=v.paramsParse(i);v.report("hover",null!=a?a:{});break}if(!o.parentElement)break;o=o.parentElement}})),i(l(v),"paramsParse",(function(t){if("string"==typeof t)try{var e=JSON.parse(t);if("[object Object]"===Object.prototype.toString.call(e))return e}catch(r){}})),i(l(v),"getAreaKey",(function(t){if(t&&Object.keys(t).length>0)return null==t||t.areaId,null==t||t.positionId,null!=t&&t.positionId?"".concat(null==t?void 0:t.areaId,"-").concat(null==t?void 0:t.positionId):"".concat(null==t?void 0:t.areaId)})),i(l(v),"trackExposure",(function(){v.addIntersectionObserver(),v.addMutationObserver(document.querySelector(v.containerSelector))})),i(l(v),"isIntersectCallBack",(function(t,e){if(v.areaStayMap.has(e)){var r=v.areaStayMap.get(e);if(r)r.activeTime,r.duration,Date.now()}else v.areaStayMap.set(e,{isReport:!1,activeTime:Date.now(),duration:0,param:t}),v.report("areaView",t)})),i(l(v),"unIntersectCallBack",(function(t,r){var n=v.areaStayMap.get(r);if(n){var o=n.activeTime,i=n.duration,a=n.isReport;if(0!==o&&!a){var c=Date.now()-o+i;v.areaStayMap.set(r,e(e({},n),{},{isReport:!0,duration:c,activeTime:0})),v.report("areaStay",e(e({},t),{},{duration:c}))}}})),i(l(v),"addIntersectionObserver",(function(){var t=Array.from(document.querySelectorAll("[".concat(v.exposureSelector,"]"))).filter((function(t){return t.getAttribute(v.exposureSelector)}));v.intersectionObserver&&v.intersectionObserver.disconnect(),v.intersectionObserver=new IntersectionObserver((function(t){var e,r=p(t);try{for(r.s();!(e=r.n()).done;){var n=e.value,o=n.target.getAttribute(v.exposureSelector),i=v.paramsParse(o);if(i){var a=v.getAreaKey(i);a&&(n.isIntersecting&&"1"===getComputedStyle(n.target).opacity?v.isIntersectCallBack(i,a):v.unIntersectCallBack(i,a))}}}catch(c){r.e(c)}finally{r.f()}}));var e,r=p(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;v.intersectionObserver.observe(n)}}catch(o){r.e(o)}finally{r.f()}})),i(l(v),"addMutationObserver",(function(t){var e=t,r=new MutationObserver((function(){v.addIntersectionObserver()}));e&&r.observe(e,{attributes:!0,childList:!0,subtree:!0})})),i(l(v),"now",(function(){return v.status})),v.isDev=null!==(o=null==t?void 0:t.isDev)&&void 0!==o?o:v.isDev,v.clickSelector=null!==(a=null==t?void 0:t.clickSelector)&&void 0!==a?a:v.clickSelector,v.hoverSelector=null!==(s=null==t?void 0:t.hoverSelector)&&void 0!==s?s:v.hoverSelector,v.exposureSelector=null!==(u=null==t?void 0:t.exposureSelector)&&void 0!==u?u:v.exposureSelector,v.idleDuration=null!==(d=null==t?void 0:t.idleDuration)&&void 0!==d?d:v.idleDuration,v.containerSelector=null!==(h=null==t?void 0:t.containerSelector)&&void 0!==h?h:v.containerSelector,v.isDev||(v.addActivePageListener(),v.visibilitychangeHandler()),v.trackHover(),v.trackClick(),v.trackExposure();var f=new b;return Object.assign(l(v),{startCreate:f.startCreate.bind(f),stopCreate:f.stopCreate.bind(f)}),v}return o(c,[{key:"reportPageStay",value:function(){var t=Date.now()-this.activeStartTime+this.pageStayDuration;this.report("pageStay",{duration:t}),this.pageStayDuration=t,this.activeStartTime=Date.now()}},{key:"reportAreaStay",value:function(){var t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=p(this.areaStayMap.entries());try{for(n.s();!(t=n.n()).done;){var o=h(t.value,2),i=o[0],a=o[1],c=a.param,s=a.activeTime,l=a.duration,u=a.isReport;if(0!==s&&!u){var d=Date.now(),v=d-s+l;this.areaStayMap.set(i,e(e({},a),{},{isReport:r,duration:v,activeTime:d})),this.report("areaStay",e({duration:v},c))}}}catch(f){n.e(f)}finally{n.f()}}},{key:"updateAreaStayActiveTime",value:function(){var t,r=p(this.areaStayMap.entries());try{for(r.s();!(t=r.n()).done;){var n=h(t.value,2),o=n[0],i=n[1],a=i.activeTime,c=i.isReport;if(0!==a&&!c){var s=Date.now();this.areaStayMap.set(o,e(e({},i),{},{activeTime:s}))}}}catch(l){r.e(l)}finally{r.f()}}}]),c}(g);return window.QC_COMMUNITY_TRACK=w,w}();
